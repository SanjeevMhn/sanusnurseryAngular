<section class="cart-section dynamic-section">
    <div class="inner-container">
        <ul class="breadcrumb-list">
            <li class="breadcrumb-item">
                <a routerLink="/" class="breadcrumb-link">Home</a>
            </li>
            <li class="breadcrumb-item">
                <a class="breadcrumb-link">Cart</a>
            </li>
        </ul>

        <article class="cart-details-container h-[calc(100%-51px)] flex flex-col md:pb-[30px]">
            <article class="cart-items-container pb-[10px] md:pb-0 flex-grow overflow-y-auto mb-[15px] md:mb-[35px]">
                <div
                    class="title-container flex justify-between  pb-[15px] md:sticky md:top-0 bg-[#e1e1e1] z-[10] header-text">
                    <h2 class="text-lg md:text-2xl">Shopping Cart
                    </h2>
                    <span class="items-counter text-lg">{{cartItems.length > 1 ? cartItems.length + " items" :
                        cartItems.length === 0 ? cartItems.length + " items" : cartItems.length + " item" }}</span>
                </div>
                <table class="cart-items-table">
                    <thead>
                        <tr>
                            <th data-name="name">Product</th>
                            <th data-name="quantity">Quantity</th>
                            <th data-name="price">Price</th>
                            <th data-name="total">Total</th>
                            <th data-name="action">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of cartItems">

                            <app-cart-item [item]="item"
                                (increaseCartItemQuantityEvent)="increaseCartItemQuantity(item)"
                                (decreaseCartItemQuantityEvent)="decreaseCartItemQuantity(item)"
                                (setProductQuantityEvent)="setProductQuantity($event)"
                                (removeCartItemEvent)="removeCartItem(item)" class="contents">
                            </app-cart-item>

                        </tr>
                    </tbody>
                </table>

                <div class="cart-total-recipt-sp hidden p-[15px] bg-[#e1e1e1]  border-t border-black">
                    <ul class="receipt-list flex w-fill flex-col pb-[25px]">
                        <li class="receipt-list-item flex">
                            <span class="label-text flex-grow font-semibold text-[#282828]">Order Subtotal:</span>
                            <span class="data flex-grow font-semibold justify-end">Rs.&nbsp;{{subTotal}}</span>
                        </li>
                    </ul>
                </div>
            </article>
            <aside class="total-amount-receipe block pt-[10px] md:pt-0 flex-grow w-full">
                <h2 class="text-lg md:text-2xl pb-[15px] header-text hidden md:block">Cart Summary</h2>
                <div
                    class="receipt-list-container p-[15px] md:p-[25px] rounded-[10px] bg-[#efefef] sticky top-0 shadow-lg">
                    <ul class="receipt-list flex w-fill flex-col">
                        <li class="receipt-list-item flex">
                            <span class="label-text flex-grow font-semibold text-[#282828]">Order Subtotal:</span>
                            <span class="data flex-grow font-semibold justify-end">Rs.&nbsp;{{subTotal}}</span>
                        </li>
                    </ul>
                    <form class="checkout-form py-[35px]" [formGroup]="checkoutForm" (submit)="checkout()">
                        <h2 class="header-text">Checkout Details</h2>
                        <!-- <p *ngIf="formMessage" class="py-2 text-red-700 font-medium text-md">{{formMessage}}</p> -->
                        <div class="form-row">

                            <div class="form-group">
                                <label for="ftname" class="required-label">First Name</label>
                                <input type="text" name="ftname" id="name" class="" [ngClass]="getFieldClass('ftname')"
                                    placeholder="Your First Name" formControlName="ftname" required>
                                <div class="invalid-msg text-red-700 font-medium text-sm" *ngIf="errorFtName">
                                    {{errorFtNameMsg}}
                                </div>

                            </div>
                            <div class="form-group">
                                <label for="ltname" class="required-label">Last Name</label>
                                <input type="text" name="ltname" id="name" class="" [ngClass]="getFieldClass('ltname')"
                                    placeholder="Your Last Name" formControlName="ltname" required>
                                <div class="invalid-msg text-red-700 font-medium text-sm" *ngIf="errorLtName">
                                    {{errorLtNameMsg}}
                                </div>

                            </div>
                            <div class="form-group">
                                <label for="phone" class="required-label">Phone</label>
                                <input type="tel" name="phone" id="phone" class="" [ngClass]="getFieldClass('phone')"
                                    placeholder="Your Phone" formControlName="phone" required>
                                <div class="invalid-msg text-red-700 font-medium text-sm" *ngIf="errorPhone">
                                    {{errorPhoneMsg}}
                                </div>

                            </div>
                            <div class="form-group">
                                <label for="email" class="required-label">Email</label>
                                <input type="email" name="email" id="email" class="" [ngClass]="getFieldClass('email')"
                                    placeholder="Your Email" formControlName="email">
                                <div class="invalid-msg text-red-700 font-medium text-sm" *ngIf="errorEmail">
                                    {{errorEmailMsg}}
                                </div>

                            </div>
                            <div class="form-group">
                                <label for="address" class="required-label">Address</label>
                                <input type="text" name="address" id="address" class=""
                                    [ngClass]="getFieldClass('address')" placeholder="Your Address"
                                    formControlName="address" required>
                                <div class="invalid-msg text-red-700 font-medium text-sm" *ngIf="errorAddress">
                                    {{errorAddressMsg}}
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="payment-option" class="required-label">
                                    Payment Type
                                </label>
                                <ul class="payment-option-list flex flex-wrap gap-3 items-center flex-grow">
                                    <li class="payment-option-item flex items-center">
                                        <input type="radio" name="payment_type" id="cash" value="1" checked formControlName="payment_type">
                                        <label for="cash" class="pl-[5px]">Cash on Delivery</label>
                                    </li>
                                    <li class="payment-option-item flex items-center">
                                        <input type="radio" name="payment_type" id="esewa" value="2" formControlName="payment_type">
                                        <label for="esewa" class="pl-[5px]">ESewa</label>
                                    </li>
                                    <li class="payment-option-item flex items-center">
                                        <input type="radio" name="payment_type" id="khalti" value="3" formControlName="payment_type">
                                        <label for="khalti" class="pl-[5px]">Khalti</label>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </form>
                    <div class="actions-container flex flex-col-reverse md:flex-row md:justify-center items-center">
                        <a routerLink="/home/products" role="button" class="text-primary md:mr-2">Continue Shopping?</a>
                        <button type="button"
                            class="flex p-[5px_20px] bg-primary text-lg text-white rounded-full mb-4 md:mb-0 md:ml-2"
                            [ngClass]="cartItems.length < 1 || !subTotal || subTotal === 0 ? 'disabled' : ''"
                            (click)="checkout()"
                            [disabled]="cartItems.length < 1 || !subTotal || subTotal === 0">Checkout</button>
                    </div>

                </div>

            </aside>
        </article>

        <article
            class="receipt-container w-full flex justify-center bg-[#0007] z-[999] absolute top-0 left-0 bottom-0 right-0 h-full overflow-y-auto"
            [ngClass]="paymentReceipt && showBill ? 'block' : 'hidden' ">
            <button type="button"
                class="close-btn w-[35px] h-[35px] absolute top-[20px] right-[20px] rounded-full flex items-center justify-center bg-primary"
                (click)="closeBill()">
                <fa-icon [icon]="faClose" class="text-white text-[25px]"></fa-icon>
            </button>
            <div class="table-container max-w-[768px] max-h-[842px] w-full p-[15px] md:p-[30px] bg-white"
                id="payment-receipt">
                <header class="table-header text-center pb-[25px] md:pb-[50px]">
                    <h2 class="company-name text-[18px] md:text-[35px]">
                        Sanu's Nursery
                    </h2>
                    <p class="text-[8px] md:text-[15px]">Dhapakhel-24, Lalitpur</p>
                    <p class="text-[8px] md:text-[15px]">+9779851243855, +9779841218573</p>
                </header>
                <div class="customer-info flex flex-wrap w-full pb-[12px] md:pb-[20px] text-[8px] md:text-base">
                    <div class="customer-info-item flex-[1_0_calc(100%)] pb-[2px] md:pb-2">
                        <span class="label-text pr-2">Date:</span>
                        <span class="data">{{ paymentReceipt?.date }}</span>
                    </div>
                    <div class="customer-info-item flex-[1_0_calc(100%/2)] pb-[2px] md:pb-2">
                        <span class="label-text pr-2">Name:</span>
                        <span class="data break-words">{{ paymentReceipt?.name }}</span>
                    </div>
                    <div class="customer-info-item flex-[0_0_calc(100%/2)] pb-[2px] md:pb-2">
                        <span class="label-text pr-2">Phone:</span>
                        <span class="data">{{ paymentReceipt?.phone }}</span>
                    </div>
                    <div class="customer-info-item flex-[0_0_calc(100%/2)] pb-[2px] md:pb-2">
                        <span class="label-text pr-2">Address:</span>
                        <span class="data">{{ paymentReceipt?.address }}</span>
                    </div>
                </div>

                <div class="table-border table-responsive overflow-x-auto">

                    <table class="receipt-table w-full text-[8px] md:text-base">
                        <thead>
                            <tr>
                                <th data-name="sn">S.N</th>
                                <th data-name="name">Product</th>
                                <th data-name="quantity">Quantity</th>
                                <th data-name="price">Price</th>
                                <th data-name="total">Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of paymentReceipt?.products; let i=index">
                                <td data-name="sn">{{i+1}}</td>
                                <td data-name="name">{{item.prod_name}}</td>
                                <td data-name="quantity">{{item.quantity}}</td>
                                <td data-name="price">{{item.prod_price}}</td>
                                <td data-name="total">{{item.total}}</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3">

                                </td>
                                <td data-name="subtotal" class="font-[700]">Sub Total</td>
                                <td data-name="subtotal">{{paymentReceipt?.subTotal}}</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </article>
    </div>

</section>